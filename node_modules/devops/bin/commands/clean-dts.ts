import { glob } from "glob";
import { resolve } from "path";
import { unlink } from "fs";

export default async function run() {
  /**
   * Occasionally it happens that .d.ts files get generated while managing the build system
   */
  let matches = await glob(resolve("src", "**", "*.d.ts"));
  matches.forEach((fileName) => {
    unlink(fileName, (err) => {
      if (err) console.warn("Could not remove", fileName);
    });
  });

  matches = await glob(resolve("ui", "**", "*.d.ts"));
  matches.forEach((fileName) => {
    unlink(fileName, (err) => {
      if (err) console.warn("Could not remove", fileName);
    });
  });

  matches = await glob(resolve("app", "**", "*.d.ts"));
  matches.forEach((fileName) => {
    unlink(fileName, (err) => {
      if (err) console.warn("Could not remove", fileName);
    });
  });

  matches = await glob(resolve("util", "**", "*.d.ts"));
  matches.forEach((fileName) => {
    unlink(fileName, (err) => {
      if (err) console.warn("Could not remove", fileName);
    });
  });

  matches = await glob(resolve("test", "**", "*.d.ts"));
  matches.forEach((fileName) => {
    unlink(fileName, (err) => {
      if (err) console.warn("Could not remove", fileName);
    });
  });

  matches = await glob(resolve("unit-test", "**", "*.d.ts"));
  matches.forEach((fileName) => {
    unlink(fileName, (err) => {
      if (err) console.warn("Could not remove", fileName);
    });
  });
}
