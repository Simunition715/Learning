import fs from "fs-extra";
import { promptConfirm } from "../prompt/prompt-confirm.js";

/**
 * Writes the file to the specified destination and provides override file
 * checks and prompts
 */
export async function writeFilePrompt(path: string, file: string) {
  console.warn("Creating file:", path);

  if (fs.existsSync(path)) {
    const answer = await promptConfirm(
      `File already exists. Replace contents with new component default?`,
      false
    );

    if (answer) {
      console.warn("Skipped file");
      return;
    }
  }

  // Write the component template files
  try {
    fs.writeFileSync(path, file, { encoding: "utf-8" });
  } catch (err) {
    throw new Error(`Could not create file ${path}`);
  }

  console.warn("Created file");
  return path;
}
