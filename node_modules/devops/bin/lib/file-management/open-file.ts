import fs from "fs-extra";
import shell from "shelljs";
import { wait } from "../util/wait.js";

function canOpen(path?: string | null) {
  return path && fs.existsSync(path) && !fs.statSync(path).isDirectory();
}

/**
 * This opens the specified file at the path in the editor for immediate review
 */
export async function openFile(path?: string | (string | undefined | null)[]) {
  if (Array.isArray(path)) {
    shell.exec(`code -r ${path.filter(canOpen).join(" ")}`, { async: true });
    await wait(10);
  } else if (canOpen(path)) {
    // Use VS Code as our editor for opening the file
    shell.exec(`code -r ${path}`, { async: true });
  }
}
