import path from "path";

/**
 * Takes a file pathing object and outputs a list of the files inside of it.
 *
 * Provide a null basePath to prevent absolute file pathing.
 *
 * NOTE: This is intended to work alongside gather-files-as-object.ts by using
 * the latters output as the input for this function.
 */
export function aggregateFilePaths(
  basePath: string | null,
  obj: any | null,
  out: string[] = []
) {
  if (!obj) {
    if (!basePath) return out;
    out.push(basePath);
    return out;
  }

  if (!basePath) basePath = "";
  const base = basePath;

  Object.keys(obj).forEach((key) => {
    const next = obj[key];
    const pathToKey = path.join(base, key);

    if (typeof next === "string") {
      out.push(`${pathToKey}${next}`);
    } else {
      aggregateFilePaths(pathToKey, next, out);
    }
  });

  return out;
}
